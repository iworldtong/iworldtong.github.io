---
layout: post
title: "Manjaro 折腾笔记（配置深度学习开发环境）"
subtitle: ''
author: "iworld"
header-img: img/2019-04-24-Manjaro 折腾笔记（配置深度学习开发环境）.jpg
tags:
  - Linux
---

### 0 目录

- [1.源镜像与系统更新](#1)
- [2.常用软件](#2)
- [3.深度学习环境](#3)
- [4.安装软件时可能遇到的问题](#4)

<br>

### <span id="1">1.源镜像与系统更新</span>

- #### 换源

  **官方镜像源（包括 core， extra， community， multilib）**

  ```shell
  sudo pacman-mirrors -i -c China -m rank //更新镜像排名，可以只留下清华源能令带宽跑满
  sudo pacman -Syy //更新数据源
  ```

  **archlinuxcn 源（中科大 ）**

  在 `/etc/pacman.conf` 末尾添加两行：

  ```shell
  [archlinuxcn]
  Server = https://mirrors.ustc.edu.cn/archlinuxcn/$arch
  ```

  然后安装 `archlinuxcn-keyring` 包以导入GPG key

- #### 更新系统

  `sudo pacman -Syyu`

<br>

### <span id="2">2.常用软件</span>

* #### 换包管理

  ```shell
  sudo pacman -S yay		# yay不用sudo了
  ```

* #### 科学上网

  ```shell
  yay -S shadowsocks-qt5
  ```

  **配置终端走代理**

  向 `~/.bashrc` 添加下面两行

  ```shell
  alias proxy="export all_proxy=socks5://127.0.0.1:1080" # 自己修改代理端口
  alias unproxy="unset all_proxy"
  ```

* #### 微信 & TIM

  ```shell
  yay -S deepin-wechat
  yay -S electronic-wechat  # wechat代替解决方案
  yay -S deepin-wine-tim
  ```

* #### 网易云音乐

  ```shell
  yay -S netease-cloud-music
  yay -S iease-music # 第三方
  ```

* #### docky

  ```shell
  yay -S docky
  ```

* #### 中文/搜狗输入法

  ```shell
  yay -S fcitx fcitx-configtool fcitx-sogoupinyin # 安装sougou需要走代理
  ```

  向 `~/.xprofile` 添加

  ```shell
  export GTK_IM_MODULE=fcitx
  export QT_IM_MODULE=fcitx 
  export XMODIFIERS=@im=fcitx
  ```

  注销用户重新登录使	修改生效

* #### Chrome浏览器

  ```shell
  yay -S google-chrome
  source ~/.bashrc
  ```

  使修改生效

<br>

### <span id="3">3.深度学习环境</span>

**安装anaconda**（清华源）

```shell
yay -S anaconda
```

添加环境变量，打开 `~/.bashrc` 写入

```
export PATH=/opt/anaconda/bin/:$PATH
```

添加清华源 

```
conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/
```

**安装硬件驱动**

打开 Manjaro Settings Manager，点击硬件设定，点击 Auto Install Proprietary Driver

**Tensorflow**

```
conda install tensorflow-gpu
```

**Pytorch**

参考[官网](https://pytorch.org/)安装命令（优先pip安装，condo install有可能会出现 No module named 'torch'）

<br>

### <span id="4">4.安装软件时可能遇到的问题</span>

* #### [archlinuxcn-keyring无法安装](https://bbs.archlinuxcn.org/viewtopic.php?id=4129)

  ```shell
  pacman -Syu haveged
  systemctl start haveged
  systemctl enable haveged
  
  rm -fr /etc/pacman.d/gnupg
  pacman-key --init
  pacman-key --populate archlinux
  pacman-key --populate archlinuxcn
  ```

* #### 无法找到目标文件分割所需的 strip 二进制文件

  ```shell
  yay -S --needed base-devel
  ```

* #### 一个或多个 PGP 签名无法校验

  ```shell
  gpg --recv-keys <提示的未知公共密钥>
  ```

  